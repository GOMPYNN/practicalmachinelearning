---
title: "Practical Machine Learning Course Project"
author: "Bert Haak"
date: "March 13, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

The aim of this project is to predict if a particular excercise, weight lifting, is performed cotrrectly. We are provided with data of 6 people performing weight lifting excersises in 5 different ways of which 1 is correct and the other 4 are incorrect. The original data from which the train and test data with which we are provided can be found at the following website: http://groupware.les.inf.puc-rio.br/har. The website also contains additional information regading the data and the performed study. The data is collected from accelerometers on the belt, forearm, arm and the dumbell itself.

## Data Exploration and Cleaning

The first step is to download the data and set missing values to NA.

```{r, message=FALSE, cache=TRUE}
rawtrain <- "pml-training.csv"; rawtest <- "pml-testing.csv"

if(!file.exists(rawtrain) | !file.exists(rawtest)) {
        trainUrl <- "https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv"
        testUrl <- "https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv"
        download.file(url = trainUrl, destfile = rawtrain, mode = "w")
        download.file(url = testUrl, destfile = rawtest, mode = "w")
}
dtrain <- read.csv(rawtrain, header = TRUE, na.strings = c("NA", "#DIV/0!", ""))
dtest <- read.csv(rawtest, header = TRUE, na.strings = c("NA", "#DIV/0!", ""))
```
Before taking an in depth look at the data we first clean the data of the variables which are all NA and which are near zero values.

```{r, message=FALSE, cache=TRUE}
library(dplyr)
dtrain <- tbl_df(dtrain); dtest <- tbl_df(dtest)

ColnotNA <- as.vector( which( colSums( is.na(dtrain) ) <= 0.95 * nrow(dtrain) ) )

dtrain <- dtrain %>% select(ColnotNA)
dtest <- dtest %>% select(ColnotNA)


```
